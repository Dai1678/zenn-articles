---
title: "Google Playの自動保護機能に引っかかったらどうなるのかやってみた"
emoji: "😽"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Android", "Google Play"]
published: false
---

## はじめに

:::message alert
本記事は筆者の手元の環境で再現できた事象に基づくものであり、Google Playが公式に解説している内容ではありません。また、今後Google Playの動作が変更される可能性があることをご了承ください。
:::

## Google Playの自動保護機能とは

Google Play Consoleには、アプリを不正な使用や改ざんから保護するための自動保護機能が用意されています。この機能により、開発者は追加のコーディングを行うことなく、アプリのセキュリティを向上させることができます。

自動保護機能には複数の種類があり、その中の1つが「インストーラチェック機能」です。この機能は、アプリが正規のGoogle Playストア経由でインストールされたかをアプリ起動時に検証し、不正なインストールを防ぐ役割を果たしています。これにより、ユーザーが確実にGoogle Playから正式なアプリのアップデートを受け取れるようにする効果があります。  

[自動保護で不正な再配布を防ぎ、Google Play でアプリを入手するよう求めるメッセージを表示する - Play Console ヘルプ](https://support.google.com/googleplay/android-developer/answer/10183279?hl=ja)

## 実際に遭遇した事象

今回、ユーザーからアプリを起動した直後にPlayストアアプリのログイン画面に強制遷移されるという問い合わせを受けました。アプリ側ではそのような遷移処理は実装していないため、何が原因なのか調査を開始しました。

Google Play Consoleの設定を確認していく中で、自動保護の設定の1つであるインストーラチェック機能によってこの事象が発生している可能性があることを突き止めました。

![](/images/google_play_installer_check_tips/play_console_automatic_protection_settings.png)

## 再現手順

実際にこの現象を再現するために、以下の手順で検証しました。

1. 端末にGoogleアカウントを追加
2. Playストアでアプリをインストール
3. 端末からGoogleアカウントを削除
4. 手順2でインストールしたアプリを起動
5. Playストアアプリのログイン画面に強制遷移される

この手順により、インストーラチェック機能が動作していることを確認できました。

## まとめ

インストーラチェック機能は、不正なインストールを防ぎつつ、ユーザーが確実にアプリのアップデートを受け取れるようにするための重要な機能です。実際に問題が発生した場合にユーザーがどのような体験をするのか、今回初めて確認できました。

一度端末に追加したGoogleアカウントを削除するユースケースは一般的ではないと考えられますが、このような問い合わせを受けた際に以下の点を確認することをお勧めします：

- Google Play Consoleでの自動保護設定の状況
- 端末にGoogleアカウントが追加されており、Playストアアプリが利用可能な状態になっていること

これらの確認により、類似した問題の原因を特定しやすくなるでしょう。

